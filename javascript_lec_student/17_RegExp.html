<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>regexp</title>
</head>
<body>

<!--
1. 정규 표현식(Regular Expression)
  1) 특정한 규칙을 가진 문자열의 집합을 표현하기 위한 형식 언어입니다.
  2) 텍스트 데이터에서 특정 패턴이나 규칙을 가진 문자열을 찾거나, 대체하거나, 검증할 때 사용됩니다.
    (예: 전화번호, 이메일, 우편번호 등 형식을 갖춘 문자열을 찾거나 처리할 수 있습니다.)
  3) 주요 특징
    (1) 패턴 기반        : 문자열 내에서 찾고자 하는 규칙(패턴)을 미리 정의합니다.
    (2) 다양한 언어 지원 : Python, Java, JavaScript, Excel 등 거의 모든 프로그래밍 언어에서 지원합니다.
    (3) 실무 활용        : 데이터 유효성 검사, 데이터 추출, 일괄 치환 등 다양한 실무 작업에 널리 쓰입니다.


2. JavaScript의 정규 표현식
  1) 작성 방법
    (1) 리터럴 표기법
      ① const reg = /pattern/
      ② const reg = /pattern/flags
    (2) 생성자 이용
      ① const reg = new RegExp('pattern')
         const reg = new RegExp('pattern', 'flags')
      ② const reg = new RegExp(/pattern/)
         const reg = new RegExp(/pattern/, 'flags')
  2) 플래그(flag)
    (1) 검색 동작을 제어하는 옵션입니다. 패턴 뒤에 붙여서 사용하며, 여러 플래그를 동시에 조합할 수 있습니다.
    (2) 플래그를 이용해 대소문자 구분, 전체 검색, 여러 줄 검색 등 다양한 조건을 손쉽게 설정할 수 있습니다.
    (3) 주요 플래그
      ------------------------------------------------------------------------------------------------
       플래그  | 이름          | 설명
      ---------+---------------+----------------------------------------------------------------------
       g       | global        | 입력 전체에서 모든 매칭을 찾음 (플래그가 없으면 첫 번째 매칭만 찾음)
       i       | ignore case   | 대소문자 구분 없이 검색
       m       | multiline     | 여러 줄 문자열에서 ^, $가 각 줄의 시작/끝에 적용됨
       s       | dotAll        | 마침표(.)가 줄바꿈 문자(\n)까지 포함하여 매칭ㄴ
       u       | unicode       | 유니코드 4바이트 문자(이모지 등)도 올바르게 처리
      ------------------------------------------------------------------------------------------------


3. 정규 표현식 메타 문자
  1) 정규 표현식에서 사용하는 특별한 의미를 가진 문자를 의미합니다.
  2) 주요 메타 문자
    ---------------------------------------------------------------------------------------------------------------------
     메타 문자 | 의미                                          | 예시
    -----------|-----------------------------------------------|---------------------------------------------------------
     .         | 모든 단일문자                                 | b.at     : baat, bbat, bcat, bdat, ... (불가 bat, baaat)
     *         | 0개 이상의 반복 문자                          | goo*     : go, god, good, goood, ...
     +         | 1개 이상의 반복 문자                          | goo+     : goo, good, goood, ...
     ^         | 시작이 일치하는 문자                          | ^a       : app, apple, asia, africa, ...
     $         | 끝이 일치하는 문자                            | end$     : end, the end, ... (불가 ending)
     ?         | 0개 이상의 문자                               | colo?r   : color, colour
     ()        | 괄호 내의 문자를 문자 패턴으로 간주(그룹화)   | (app)A?  : appA, appappA, appappappA, ...
     |         | 또는                                          | a(b|c)   : ab, ac
     \         | 역슬래시 뒤 메타 문자를 일반 문자로 간주      | \.       : .
     {m}       | 정확히 m개 문자 (0 <= m <= 255)               | a{3}     : aaa
     {m,}      | m개 이상 문자 (0 <= m <= 255)                 | a{3,}    : aaa, aaaa, aaaaa, ...
     {m,n}     | m개 이상 n개 이하 문자 (0 <= m <= 255)        | a{2,3}   : aa, aaa
     [ ]       | 대괄호 안 문자 중 하나와 일치                 | [a-z]    : 소문자 a~z 중 하나
     [^ ]      | 대괄호 안 문자를 제외한 나머지와 일치         | [^a]     : 문자 a 를 제외한 나머지 모든 문자
     \d        | 숫자(0~9)와 일치                              | \d{3}    : 숫자 3자리 (000 ~ 999)
     \w        | 영문자/숫자/밑줄 중 하나와 일치               | \w{4,12} : 영문자/숫자/밑줄로 4~12자 구성(예: 아이디)
    --------------------------------------------------------------------------------------------------------------------


4. 정규 표현식 관련 메소드
  1) RegExp 객체 메소드
    (1) RegExp.prototype.test(문자열)
      ① 해당 문자열이 정규식과 매칭되면 true, 아니면 false를 반환합니다.
      ② 예시: /apple/.test("I like apple") → true
    (2) RegExp.prototype.exec(문자열)
      ① 정규식에 매칭되는 문자열을 배열로 반환합니다. 매칭되는 값이 없으면 null을 반환합니다.
      ② 예시: /a/.exec("abcdef") → ['a']
  2) String 객체 메소드
    (1) String.prototype.match(정규식)
      ① 문자열에서 정규식에 매칭되는 항목들을 배열로 반환합니다. 플래그에 따라 반환 형식이 달라질 수 있습니다.
      ② 예시: "abcdef".match(/a/) → ['a']
    (2) String.prototype.replace(정규식, 대체문자열)
      ① 정규식에 매칭되는 부분을 대체문자열로 변환하여 반환합니다.
      ② 예시: "abcdef".replace(/a/, "A") → "Abcdef"
    (3) String.prototype.search(정규식)
      ① 정규식에 매칭되는 부분의 첫 번째 인덱스를 반환합니다. 없으면 -1을 반환합니다.
      ② 예시: "abcdef".search(/d/) → 3
    (4) String.prototype.split(정규식)
      ① 정규식에 매칭되는 부분을 기준으로 문자열을 쪼개어 배열로 반환합니다.
      ② 예시: "a,b,c".split(/,/) → ['a', 'b', 'c']
-->

  <script>
    {
      const str = "Hello World";
      // const regexp = /a/;
      // const regexp = /[al]/; // a 또는 l
      const regexp = /[al]/g;   // flag 사용() - g(모든 패턴 매칭)
      // 플래그가 없으면 첫번째만 매칭
      console.log("RegExp text(): ", regexp.test(str));
      console.log("RegExp exec(): ", regexp.exec(str));
      console.log("String match(): ", str.match(regexp));
      console.log("String search(): ", str.search(regexp));
    }
  </script>

  <style>
    .match{color:limegreen;}
    .not-match{color:crimson;}
    p{margin:0 0 5px;}
  </style>

  <div>
    <p>숫자 5개만 허용</p>
    <input type="text" id="post">
    <button id="btn-post">우편번호검사</button>
    <span id="span-post"></span>
  </div>
  <script>
    function verifyPost(){
      const post = document.getElementById("post");
      const spanPost = document.getElementById("span-post");
      // const regexp = /[0-9]{5}/; // 숫자가 5개만 들어가면 true (123456, 12345abc 전부 true)
      const regexp = /^[0-9]{5}$/;  // 시작과 끝을 숫자 5개로 고정을 하면 숫자 5개인 경우만 true
      
      document.getElementById("btn-post").addEventListener("click",function(){
        if(regexp.test(post.value)){
          spanPost.textContent = "우편번호 입니다.";
          spanPost.classList = "match";
        } else{
          spanPost.textContent = "우편번호가 아닙니다.";
          spanPost.classList = "not-match";
        }
      })
    }
    verifyPost();

    /*
      010-1111-1111
      01011111111
      0101111-1111
      010-11111111
    */
  </script>

  <hr>

  <p>01012345678 / 010-12345678 / 0101234-5678 / 010-1234-5678</p>
  <input type="text" id="mobile">
  <button id="btn-mobile">번호검사</button>
  <span id="span-mobile"></span>
  <script>
    function verifyMobile(){
      const mobile = document.getElementById("mobile");
      const spanMobile = document.getElementById("span-mobile");
      const regexp = /^010(-?[0-9]{4}){2}$/;   // "010-1234-5678" 자체를 하나로 보고 유효성 체크를 진행 > input 입력값이 010-1234-56789 라면 010-1234-5678 까지가 $의 영역 따라서 9는 오류성 검사에서 false

      document.getElementById("btn-mobile").addEventListener("click",function(){
        if(regexp.test(mobile.value)){
          spanMobile.textContent = "핸드폰번호 입니다.";
          spanMobile.classList = "match";
        } else{
          spanMobile.textContent = "핸드폰번호가 아닙니다.";
          spanMobile.classList = "not-match";
        }
      })
    }

    verifyMobile();
  </script>

  <hr>

  <!-- 비밀번호 -->
  <p>대문자, 소문자, 숫자, 특수문자 중 3가지 이상을 사용한 4 ~ 20자</p>
  <input type="text" id="pw">
  <button type="button" id="btn-pw">비밀번호검사</button>
  <span id="span-pw"></span>
  <script>
    function verifyPW(){
      document.getElementById("btn-pw").addEventListener("click",function(){
        const pw = document.getElementById("pw");
        const spanPw = document.getElementById("span-pw");
        const length = pw.value.length;   // 입력한 비밀번호의 문자수 검사
        const ruleCount = /[A-Z]/.test(pw.value)    // 대문자가 있으면 true(true는 숫자로 1)
                        + /[a-z]/.test(pw.value)    // 소문자가 있으면 true(false는 숫자로 0)
                        + /[0-9]/.test(pw.value)    // 숫자 있으면 true
                        + /[!@#]/.test(pw.value)    // !,@,# 있으면 true
                        // + /[^A-Za-z0-9]/.test(pw.value)    대문자,소문자,숫자를 제외한 문자가 있으면 true(모든 특수문자 허용)
      
        console.log(length, ruleCount);
        if(length >= 4 && length <= 20 && ruleCount >= 3){
          spanPw.textContent = "올바른 비밀번호입니다.";
          spanPw.classList = "match";
        } else{
          spanPw.textContent = "올바르지 않은 비밀번호입니다.";
          spanPw.classList = "not-match";
        }
      })
    }

    verifyPW();
  </script>

  <hr>

  <p>아이디 : 소문자/숫자/특수문자(-,_) 가능, 첫 글자 소문자만 가능, 글자 수 4 ~ 20자</p>
  <input type="text" id="id">
  <button id="btn-id">아이디검사</button>
  <span id="span-id"></span>
  <script>
    document.getElementById("btn-id").addEventListener("click",function(){
      // 아이디 : 소문자/숫자/특수문자(-,_) 가능, 첫 글자 소문자만 가능, 글자 수 4 ~ 20자
      const regexp = /^[a-z][a-z0-9-_]{3,19}$/;
      if(regexp.test(document.getElementById("id").value)){
        document.getElementById("span-id").textContent = "올바른 아이디";
        document.getElementById("span-id").classList = "match";
      } else{
        document.getElementById("span-id").textContent = "올바르지 않은 아이디";
        document.getElementById("span-id").classList = "not-match";
      }
    })
  </script>

  <hr>
  
  <p>이메일 : 아이디@호스트.도메인 or 아이디@호스트.도메인.도메인<br>아이디 : 1글자 이상 (한글은 제외, 특수기호 -_ 만 허용) <br>호스트 : 1글자 이상 (한글은 제외)<br>도메인 : .com, .org, .co.kr, .or.kr 등 (한글 제외) 2 ~ 6자</p>
  <input type="text" id="mail">
  <button id="btn-mail">메일검사</button>
  <span id="span-mail"></span>
  <script>
    document.getElementById("btn-mail").addEventListener("click",function(){
      // 이메일 : 아이디@호스트.도메인 or 아이디@호스트.도메인.도메인
      // 아이디 : 1글자 이상 (한글은 제외)  // + (1개 이상의 반복 문자)
      // 호스트 : 1글자 이상 (한글은 제외)
      // 도메인 : .com, .org, .co.kr, .or.kr 등 (한글 제외) 2 ~ 6자
      // 조건 좀 더 찾아보기
      const regexp = /^[A-Za-z0-9-_]+@[A-Za-z0-9]+(\.[a-z]{2,6}){1,2}$/;
      if(regexp.test(document.getElementById("mail").value)){
        document.getElementById("span-mail").textContent = "올바른 메일";
        document.getElementById("span-mail").classList = "match";
      } else{
        document.getElementById("span-mail").textContent = "올바르지 않은 메일";
        document.getElementById("span-mail").classList = "not-match";
      }
    })
  </script>

  <hr>

  <p>// IP주소 : 0-255.0-255.0-255.0-255</p>
  <input type="text" id="ip">
  <button id="btn-ip">아이피검사</button>
  <div id="span-ip"></div>

  <script>
    str = "";
    document.getElementById("btn-ip").addEventListener("click",function(){
      // IP주소 : 0-255.0-255.0-255.0-255
      // 0~255 / 0-9, 10-99, 100-249, 250-255
      // 0-9 [0-9]
      // 10-99 [1-9][0-9]
      // 100-199 1[0-9]{2}
      // 200-249 2[0-4][0-9]
      // 250-255 25[0-5]
      const regexp = /^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])){3}$/;
      if(regexp.test(document.getElementById("ip").value)){
        str += "<div class='match'>" + document.getElementById("ip").value + " " + "올바른 ip 입니다.</p>";
      } else{
        str += "<div class='not-match'>" + document.getElementById("ip").value + " " + "올바르지 않은 ip 입니다.</p>";
      }
      document.getElementById("span-ip").innerHTML = str;
    })
  </script>

  <hr>

  <form id="form-login" action="/login" method="get">
    <input type="text" id="user-id" placeholder="example@host.domain" name="id">
    <br>
    <input type="password" id="user-pw" placeholder="****" name="pw">
    <br>
    <button type="submit">로그인</button>
  </form>
  <script>
    function doLogin(){
      const userId = document.getElementById("user-id");
      const userPw = document.getElementById("user-pw");
      const regId = /^[A-Za-z0-9-_]+@[A-Za-z0-9]+(\.[a-z]{2,6}){1,2}$/;
      const regPw = /^[A-Za-z0-9!@#]{4,20}$/;
      document.getElementById("form-login").addEventListener("submit",function(e){
        if(!regId.test(userId.value)){
          alert("이메일을 확인하세요.");
          e.preventDefault();
        } else if(!regPw.test(userPw.value)){
          alert("비밀번호를 확인하세요.")
          e.preventDefault();
        }
      })
    }
    doLogin();
  </script>

</body>
</html>